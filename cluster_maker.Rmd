---
title: "cluster_maker"
author: "Julia Gustavsen"
date: "June 23, 2016"
output: 
    html_document:
      keep_md: true
      number_sections: yes
      theme: cerulean
      toc: yes
      toc_depth: 6 
---

```{r, message = FALSE}
library(RCy3)
library(httr)
library(RJSONIO)
source("./functions_to_add_to_RCy3/working_with_namespaces.R")
```

Trying out cluster maker with R 

```{r}
cy <- CytoscapeConnection ()
getCommandsWithinNamespace(cy, "cluster")
```


http://opentutorials.cgl.ucsf.edu/index.php/Tutorial:Cluster_Maker



## need to read in cys

```{r}
#help session

command.name <- "open"

request.uri <- paste(cy@uri,
                     pluginVersion(cy),
                     "commands/session",
                     as.character(command.name),
                     sep = "/")
## file

## load session
properties.list <- list(file="/home/julia_g/windows_school/gsoc/gsoc_Rcy3_vignettes/data/GalFiltered.cys")
request.res <- GET(url = request.uri,
                   query = properties.list)

#cy.window <- new('CytoscapeWindowClass', title=title, window.id=existing.window.id, uri=uri)
## how do I list networks in cy?
#get

getWindowList(cy)

connect_EM_to_R_session <- existing.CytoscapeWindow("galFiltered.sif",                                                                      copy.graph.from.cytoscape.to.R = FALSE)
```

Graph from session is loaded into Cytoscape

```{r}
getCommandsWithinNamespace(cy, "cluster/hierarchical")

properties.list <- list(nodeAttributeList = c("node.gal1RGexp",
                                           "node.gal4RGexp",
                                           "node.gal80Rexp"),
                     selectedOnly = FALSE)


## I think this works to send an array to via json...
node_list <- c('[ "node.gal1RGexp",
                                          "node.gal4RGexp",
                                          "node.gal80Rexp"]')

properties.list <- list(nodeAttributeList = "node.gal1RGexp",
                        selectedOnly = FALSE,
                        clusterAttributes = FALSE,
                        #ignoreMissing = FALSE,
                        createGroups = TRUE,
                        showUI = TRUE)

command.name <- "hierarchical"
request.uri <- paste(cy@uri,pluginVersion(cy),
                     "commands/cluster",
                     as.character(command.name),
                     sep = "/")

request.res <- GET(url = request.uri,
                   query = properties.list)
request.res$status_code
```

# A bit stuck here. Cannot get this to work. 

- Tried wiht the command line stuff too, but I can't add the nodes. how do I write the nodes? maybe check the xml page in the for how the nodes are listed and the columns of attributes. 

Ok so how to get this to be more like a function? make specific things for the R funciton??
- also connect to this network in R
- look at the online tutorial again-----------<

